CONTIKI_PROJECT = udp-client udp-server
TARGET1=whitefield

# all: 
# 	sudo make udp-server TARGET=$(TARGET1) IDS_SERVER=1 RPL_CONF_DEFAULT_INSTANCE=0
# 	sudo make udp-client-ids TARGET=$(TARGET1) IDS_CLIENT=1 RPL_CONF_DEFAULT_INSTANCE=0
# 	sudo make udp-client-mal TARGET=$(TARGET1) IDS_CLIENT=2
# 	sudo make udp-client-clone TARGET=$(TARGET1) IDS_CLIENT=3
# 	sudo make udp-client TARGET=$(TARGET1) IDS_CLIENT=0 RPL_CONF_DEFAULT_INSTANCE=1

#Normal server, instance 0
udp-server:
ifeq ($(IDS_SERVER),0)
$(info 'SERVER')
	DEFINES+=IDS_SERVER=0 RPL_CONF_DEFAULT_INSTANCE=0
	DEFINES+=IDS_CLIENT=0
	# MODULES=os/net/routing/ids-app 
# 	BUILD_DIR_CONFIG=server
endif

#IDS server,  instance 1
udp-server:
ifeq ($(IDS_SERVER),1)
$(info 'SERVER')
	DEFINES+=IDS_SERVER=1 RPL_CONF_DEFAULT_INSTANCE=1
	DEFINES+=IDS_CLIENT=0
	MODULES=os/net/routing/ids-app 
# 	BUILD_DIR_CONFIG=server
endif

udp-client-ids: 
ifeq ($(IDS_CLIENT),1)
$(info 'IDSCLIENT')
	DEFINES+=IDS_SERVER=0 RPL_CONF_DEFAULT_INSTANCE=1
	DEFINES+=IDS_CLIENT=1 
	DEFINES+=RPL_CONF_DEFAULT_LEAF_ONLY=0
	# DEFINES+=RPL_CONF_DAO_MAX_RETRANSMISSIONS=3 LINK_STATS_CONF_ETX_FROM_PACKET_COUNT=1
	MODULES=os/net/routing/ids-app
	# BUILD_DIR_CONFIG=ids-client
$(info DEFINE $(DEFINES))
endif

#Used for blackhole or clone nodes
udp-client-mal:
ifeq ($(IDS_CLIENT),2)
$(info 'MALICIOUS')
	DEFINES+=IDS_SERVER=0 RPL_CONF_DEFAULT_INSTANCE=0
	DEFINES+=IDS_CLIENT=0
	DEFINES+=MALICIOUS=1
	# DEFINES+=RPL_CONF_DIS_INTERVAL=30*CLOCK_SECOND
	DEFINES+=MAL_DIS=0
	DEFINES+=MAL_BLACKHOLE=1 MAL_RANK=1
# 	BUILD_DIR_CONFIG=malicious
endif


#For clone only or malicious and clone
udp-client-clone:
ifeq ($(IDS_CLIENT),3)
$(info 'CLONE ONLY')
	DEFINES+=IDS_SERVER=0
	DEFINES+=IDS_CLIENT=0
	DEFINES+=MALICIOUS=0
	DEFINES+=CLONE_ATTACK=1
	DEFINES+=MAL_DIS=0
# 	BUILD_DIR_CONFIG=clone_only
endif

ifeq ($(IDS_CLIENT),4)
$(info 'MALICIOUS and CLONE')
	DEFINES+=IDS_SERVER=0
	DEFINES+=IDS_CLIENT=0
	DEFINES+=MALICIOUS=1
	DEFINES+=CLONE_ATTACK=1
	DEFINES+=MAL_DIS=1
	DEFINES+=RPL_CONF_DIS_INTERVAL=0
# 	BUILD_DIR_CONFIG=clone_malicious
endif

#defined packet_counters to give me stats for nbr and IDS
udp-client:
ifeq ($(IDS_CLIENT),0)
$(info 'NORMAL')
	DEFINES+=IDS_SERVER=0 RPL_CONF_DEFAULT_INSTANCE=0
	DEFINES+=IDS_CLIENT=0
	DEFINES+=IDS_OF=1
	DEFINES+=MALICIOUS=0
	DEFINES+=CLONE_ATTACK=0
	DEFINES+=LINK_STATS_CONF_PACKET_COUNTERS=1  LINK_STATS_CONF_ETX_FROM_PACKET_COUNT=1
	DEFINES+=UIP_CONF_STATISTICS=1
	MODULES=os/net/routing/ids-app 
# 	BUILD_DIR_CONFIG=normal
endif

ifeq ($(IDS_CLIENT),5)
$(info 'NORMAL')
        DEFINES+=IDS_SERVER=0 RPL_CONF_DEFAULT_INSTANCE=0
        DEFINES+=IDS_CLIENT=0
        #DEFINES+=IDS_OF=1
        DEFINES+=MALICIOUS=0
        DEFINES+=CLONE_ATTACK=0
        #DEFINES+=LINK_STATS_CONF_PACKET_COUNTERS=1  LINK_STATS_CONF_ETX_FROM_PACKET_COUNT=1
        #DEFINES+=UIP_CONF_STATISTICS=1
        #MODULES=os/net/routing/ids-app
        #BUILD_DIR_CONFIG=normal
endif

CONTIKI=../..

CONTIKI_WITH_IPV6 = 1

include $(CONTIKI)/Makefile.include

# all: $(CONTIKI_PROJECT)
## enable packet counting
